{"version":3,"file":"railgun-txid-merkletrees.js","sourceRoot":"","sources":["../../../../src/services/railgun/railgun-txids/railgun-txid-merkletrees.ts"],"names":[],"mappings":";;;AAAA,oEAK0C;AAC1C,kCAAiE;AAE1D,MAAM,6BAA6B,GAAG,KAAK,EAChD,WAAwB,EACxB,WAAwB,EACxB,IAAY,EACZ,KAAa,EACb,UAAkB,EACA,EAAE;IACpB,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,MAAM,MAAM,GAAG,IAAA,gBAAS,GAAE,CAAC;IAC3B,MAAM,cAAc,GAAG,MAAM,CAAC,iBAAiB,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;IACpE,MAAM,oBAAoB,GAAG,MAAM,cAAc,CAAC,uBAAuB,CACvE,IAAI,EACJ,KAAK,CACN,CAAC;IACF,OAAO,oBAAoB,KAAK,UAAU,CAAC;AAC7C,CAAC,CAAC;AAfW,QAAA,6BAA6B,iCAexC;AAEK,MAAM,4CAA4C,GAAG,CAC1D,WAAwB,EACxB,WAAwB,EACxB,IAAY,EACZ,KAAa,EACb,WAAmB,EACD,EAAE;IACpB,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,MAAM,MAAM,GAAG,IAAA,gBAAS,GAAE,CAAC;IAC3B,MAAM,cAAc,GAAG,MAAM,CAAC,iBAAiB,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;IACpE,OAAO,cAAc,CAAC,oCAAoC,CACxD,IAAI,EACJ,KAAK,EACL,WAAW,CACZ,CAAC;AACJ,CAAC,CAAC;AAfW,QAAA,4CAA4C,gDAevD;AAEK,MAAM,yBAAyB,GAAG,KAAK,EAC5C,WAAwB,EACxB,WAAwB,EACxB,WAAmB,EACnB,EAAE;IACF,MAAM,cAAc,GAAG,IAAA,kCAA2B,EAAC,WAAW,EAAE,WAAW,CAAC,CAAC;IAC7E,MAAM,kBAAkB,GAAG,MAAM,cAAc,CAAC,2BAA2B,CACzE,WAAW,CACZ,CAAC;IACF,OAAO,IAAA,yBAAS,EAAC,kBAAkB,CAAC,CAAC;AACvC,CAAC,CAAC;AAVW,QAAA,yBAAyB,6BAUpC;AAEK,MAAM,wDAAwD,GAAG,CACtE,WAAwB,EACxB,WAAwB,EACxB,IAAY,EACZ,KAAa,EACb,cAAsB,EACL,EAAE;IACnB,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,MAAM,MAAM,GAAG,IAAA,gBAAS,GAAE,CAAC;IAC3B,MAAM,cAAc,GAAG,MAAM,CAAC,iBAAiB,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;IACpE,OAAO,cAAc,CAAC,wDAAwD,CAC5E,IAAI,EACJ,KAAK,EACL,cAAc,CACf,CAAC;AACJ,CAAC,CAAC;AAfW,QAAA,wDAAwD,4DAenE;AAEK,MAAM,yBAAyB,GAAG,KAAK,EAC5C,WAAwB,EACT,EAAE;IACjB,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,OAAO,IAAA,gBAAS,GAAE,CAAC,yBAAyB,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;AACxE,CAAC,CAAC;AALW,QAAA,yBAAyB,6BAKpC;AAEK,MAAM,0BAA0B,GAAG,KAAK,EAAE,WAAwB,EAAE,EAAE;IAC3E,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,OAAO,IAAA,gBAAS,GAAE,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC;AACvD,CAAC,CAAC;AAHW,QAAA,0BAA0B,8BAGrC;AAEK,MAAM,+BAA+B,GAAG,KAAK,EAClD,WAAwB,EACxB,WAAwB,EACxB,SAAiB,EACF,EAAE;IACjB,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,OAAO,IAAA,gBAAS,GAAE,CAAC,+BAA+B,CAChD,WAAW,EACX,KAAK,EACL,SAAS,CACV,CAAC;AACJ,CAAC,CAAC;AAXW,QAAA,+BAA+B,mCAW1C;AAEK,MAAM,wBAAwB,GAAG,KAAK,EAC3C,WAAwB,EACxB,WAAwB,EAIvB,EAAE;IACH,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,OAAO,IAAA,gBAAS,GAAE,CAAC,wBAAwB,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;AAClE,CAAC,CAAC;AATW,QAAA,wBAAwB,4BASnC;AAEK,MAAM,wBAAwB,GAAG,KAAK,EAC3C,WAAwB,EACxB,WAAwB,EACxB,IAAY,EACZ,KAAa,EACb,EAAE;IACF,MAAM,KAAK,GAAG,8BAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAChD,MAAM,MAAM,GAAG,IAAA,gBAAS,GAAE,CAAC;IAC3B,MAAM,cAAc,GAAG,MAAM,CAAC,iBAAiB,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;IACpE,MAAM,oBAAoB,GAAG,MAAM,cAAc,CAAC,uBAAuB,CACvE,IAAI,EACJ,KAAK,CACN,CAAC;IACF,OAAO,oBAAoB,CAAC;AAC9B,CAAC,CAAC;AAdW,QAAA,wBAAwB,4BAcnC","sourcesContent":["import {\n  NETWORK_CONFIG,\n  NetworkName,\n  TXIDVersion,\n  isDefined,\n} from '@railgun-community/shared-models';\nimport { getEngine, getTXIDMerkletreeForNetwork } from '../core';\n\nexport const validateRailgunTxidMerkleroot = async (\n  txidVersion: TXIDVersion,\n  networkName: NetworkName,\n  tree: number,\n  index: number,\n  merkleroot: string,\n): Promise<boolean> => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  const engine = getEngine();\n  const txidMerkletree = engine.getTXIDMerkletree(txidVersion, chain);\n  const historicalMerkleroot = await txidMerkletree.getHistoricalMerkleroot(\n    tree,\n    index,\n  );\n  return historicalMerkleroot === merkleroot;\n};\n\nexport const validateRailgunTxidOccurredBeforeBlockNumber = (\n  txidVersion: TXIDVersion,\n  networkName: NetworkName,\n  tree: number,\n  index: number,\n  blockNumber: number,\n): Promise<boolean> => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  const engine = getEngine();\n  const txidMerkletree = engine.getTXIDMerkletree(txidVersion, chain);\n  return txidMerkletree.railgunTxidOccurredBeforeBlockNumber(\n    tree,\n    index,\n    blockNumber,\n  );\n};\n\nexport const validateRailgunTxidExists = async (\n  txidVersion: TXIDVersion,\n  networkName: NetworkName,\n  railgunTxid: string,\n) => {\n  const txidMerkletree = getTXIDMerkletreeForNetwork(txidVersion, networkName);\n  const railgunTransaction = await txidMerkletree.getRailgunTransactionByTxid(\n    railgunTxid,\n  );\n  return isDefined(railgunTransaction);\n};\n\nexport const getGlobalUTXOTreePositionForRailgunTransactionCommitment = (\n  txidVersion: TXIDVersion,\n  networkName: NetworkName,\n  tree: number,\n  index: number,\n  commitmentHash: string,\n): Promise<number> => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  const engine = getEngine();\n  const txidMerkletree = engine.getTXIDMerkletree(txidVersion, chain);\n  return txidMerkletree.getGlobalUTXOTreePositionForRailgunTransactionCommitment(\n    tree,\n    index,\n    commitmentHash,\n  );\n};\n\nexport const syncRailgunTransactionsV2 = async (\n  networkName: NetworkName,\n): Promise<void> => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  return getEngine().syncRailgunTransactionsV2(chain, 'manual trigger');\n};\n\nexport const fullResetTXIDMerkletreesV2 = async (networkName: NetworkName) => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  return getEngine().fullResetTXIDMerkletreesV2(chain);\n};\n\nexport const resetRailgunTxidsAfterTxidIndex = async (\n  txidVersion: TXIDVersion,\n  networkName: NetworkName,\n  txidIndex: number,\n): Promise<void> => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  return getEngine().resetRailgunTxidsAfterTxidIndex(\n    txidVersion,\n    chain,\n    txidIndex,\n  );\n};\n\nexport const getLatestRailgunTxidData = async (\n  txidVersion: TXIDVersion,\n  networkName: NetworkName,\n): Promise<{\n  txidIndex: number;\n  merkleroot: string;\n}> => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  return getEngine().getLatestRailgunTxidData(txidVersion, chain);\n};\n\nexport const getRailgunTxidMerkleroot = async (\n  txidVersion: TXIDVersion,\n  networkName: NetworkName,\n  tree: number,\n  index: number,\n) => {\n  const chain = NETWORK_CONFIG[networkName].chain;\n  const engine = getEngine();\n  const txidMerkletree = engine.getTXIDMerkletree(txidVersion, chain);\n  const historicalMerkleroot = await txidMerkletree.getHistoricalMerkleroot(\n    tree,\n    index,\n  );\n  return historicalMerkleroot;\n};\n"]}